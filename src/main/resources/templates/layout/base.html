<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} ?: '学生信息管理系统'">学生信息管理系统</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- 自定义样式 -->
    <link th:href="@{/css/style.css}" rel="stylesheet">
    
    <th:block layout:fragment="head">
        <!-- 页面特定的头部内容 -->
    </th:block>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" th:href="@{/dashboard}">
                <i class="fas fa-graduation-cap me-2"></i>
                学生信息管理系统
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/dashboard}">
                            <i class="fas fa-home me-1"></i>首页
                        </a>
                    </li>
                    
                    <!-- 管理员菜单 -->
                    <li class="nav-item dropdown" sec:authorize="hasRole('ADMIN')">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-users-cog me-1"></i>管理
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" th:href="@{/admin/users}">
                                <i class="fas fa-users me-1"></i>用户管理
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/students}">
                                <i class="fas fa-user-graduate me-1"></i>学生管理
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/courses}">
                                <i class="fas fa-book me-1"></i>课程管理
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/scores}">
                                <i class="fas fa-chart-line me-1"></i>成绩管理
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/health-records}">
                                <i class="fas fa-heartbeat me-1"></i>健康信息管理
                            </a></li>
                        </ul>
                    </li>
                    
                    <!-- 学生菜单 -->
                    <li class="nav-item dropdown" sec:authorize="hasRole('USER')">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i>我的信息
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" th:href="@{/student/profile}">
                                <i class="fas fa-id-card me-1"></i>个人信息
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/student/scores}">
                                <i class="fas fa-chart-line me-1"></i>成绩查询
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/student/health}">
                                <i class="fas fa-heartbeat me-1"></i>健康信息
                            </a></li>
                            <li><a class="dropdown-item" th:href="@{/student/courses}">
                                <i class="fas fa-book me-1"></i>课程信息
                            </a></li>
                        </ul>
                    </li>
                </ul>
                
                <!-- 用户信息 -->
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>
                            <span sec:authentication="name">用户</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" th:href="@{/student/profile}">
                                <i class="fas fa-user me-1"></i>个人资料
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form th:action="@{/logout}" method="post" class="d-inline">
                                    <button type="submit" class="dropdown-item">
                                        <i class="fas fa-sign-out-alt me-1"></i>退出登录
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- 主要内容区域 -->
    <main class="container-fluid mt-4">
        <!-- 消息提示 -->
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <div th:if="${message}" class="alert alert-info alert-dismissible fade show" role="alert">
            <i class="fas fa-info-circle me-2"></i>
            <span th:text="${message}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <!-- 默认内容 - 仪表盘 -->
        <th:block layout:fragment="content">
            <!-- 统计卡片 -->
            <div class="row mb-4">
                <!-- 学生总数 -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-primary shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">学生总数</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${totalStudents} ?: '0'">0</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-user-graduate fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 课程总数 -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-success shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">课程总数</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${totalCourses} ?: '0'">0</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-book fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 教师总数 -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-info shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1">教师总数</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${teacherCount} ?: '0'">0</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-chalkboard-teacher fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 本月新增 -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-warning shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">本月新增学生</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" th:text="${newStudentsThisMonth} ?: '0'">0</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-user-plus fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 表格内容 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">最近注册的学生</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>学号</th>
                                    <th>姓名</th>
                                    <th>性别</th>
                                    <th>出生日期</th>
                                    <th>专业</th>
                                    <th>班级</th>
                                    <th>注册日期</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2024001</td>
                                    <td>张明</td>
                                    <td>男</td>
                                    <td>2005-03-12</td>
                                    <td>计算机科学</td>
                                    <td>计科2401</td>
                                    <td>2024-09-01</td>
                                </tr>
                                <tr>
                                    <td>2024002</td>
                                    <td>李华</td>
                                    <td>女</td>
                                    <td>2005-05-23</td>
                                    <td>软件工程</td>
                                    <td>软件2402</td>
                                    <td>2024-09-01</td>
                                </tr>
                                <tr>
                                    <td>2024003</td>
                                    <td>王芳</td>
                                    <td>女</td>
                                    <td>2005-01-18</td>
                                    <td>数据科学</td>
                                    <td>数据2401</td>
                                    <td>2024-09-02</td>
                                </tr>
                                <tr>
                                    <td>2024004</td>
                                    <td>刘强</td>
                                    <td>男</td>
                                    <td>2004-12-05</td>
                                    <td>人工智能</td>
                                    <td>智能2401</td>
                                    <td>2024-09-02</td>
                                </tr>
                                <tr>
                                    <td>2024005</td>
                                    <td>赵丽</td>
                                    <td>女</td>
                                    <td>2005-06-30</td>
                                    <td>网络工程</td>
                                    <td>网络2401</td>
                                    <td>2024-09-03</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 热门课程表格 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">热门课程</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="coursesTable" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>课程编号</th>
                                    <th>课程名称</th>
                                    <th>学分</th>
                                    <th>授课教师</th>
                                    <th>学生人数</th>
                                    <th>课程评分</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>C001</td>
                                    <td>数据结构与算法</td>
                                    <td>4</td>
                                    <td>陈教授</td>
                                    <td>120</td>
                                    <td>4.8</td>
                                </tr>
                                <tr>
                                    <td>C002</td>
                                    <td>计算机网络</td>
                                    <td>3</td>
                                    <td>王讲师</td>
                                    <td>98</td>
                                    <td>4.6</td>
                                </tr>
                                <tr>
                                    <td>C003</td>
                                    <td>数据库系统</td>
                                    <td>3</td>
                                    <td>李教授</td>
                                    <td>112</td>
                                    <td>4.7</td>
                                </tr>
                                <tr>
                                    <td>C004</td>
                                    <td>操作系统</td>
                                    <td>4</td>
                                    <td>赵教授</td>
                                    <td>105</td>
                                    <td>4.5</td>
                                </tr>
                                <tr>
                                    <td>C005</td>
                                    <td>人工智能基础</td>
                                    <td>3</td>
                                    <td>张副教授</td>
                                    <td>130</td>
                                    <td>4.9</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </th:block>
    </main>
    
    <!-- 页脚 -->
    <footer class="bg-light text-center text-muted py-3 mt-5">
        <div class="container">
            <p class="mb-0">
                <i class="fas fa-graduation-cap me-1"></i>
                WTS学生信息管理系统 &copy; 2025
            </p>
        </div>
    </footer>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 自定义脚本 -->
    <script th:src="@{/js/app.js}"></script>
    
    <th:block layout:fragment="scripts">
        <!-- 页面特定的脚本 -->
    </th:block>
</body>
</html>
